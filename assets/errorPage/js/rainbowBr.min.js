var rainbowBr=rainbowBr||{};!function(){rainbowBr.version="1.0.0",rainbowBr.scheme="cab",rainbowBr.Class=function(e,t){var n=null;"$init"in e&&(n=e.$init,delete e.$init);var i=function(){null!=n&&n.apply(this,arguments)};if("undefined"!=typeof t){i=function(){t.apply(this,arguments),null!==n&&n.apply(this,arguments)};var o=function(){};o.prototype=t.prototype,i.$super=t.prototype,i.prototype=new o,i.prototype.constructor=i}for(var a in e)e.hasOwnProperty(a)&&"prototype"!==a&&(i.prototype[a]=e[a]);return i},rainbowBr.SFactory=function(e){"undefined"==typeof rainbowBr.instances&&(rainbowBr.instances={});var t;return"undefined"==typeof rainbowBr.instances[e]?(t=new rainbowBr[e],t.setInstanceName('rainbowBr.instances["'+e+'"]'),rainbowBr.instances[e]=t):t=rainbowBr.instances[e],t},rainbowBr.Util=new(rainbowBr.Class({getDeviceInfo:function(e){if(null!==this._htDeviceInfo&&"undefined"!=typeof this._htDeviceInfo&&"undefined"==typeof e)return this._htDeviceInfo;var t=null,n=!1,i=!1,o=!1,a=!1,r=/chrome/i.test(e)?!0:!1,s=/safari/i.test(e)?!0:!1,e=e||navigator.userAgent,c=0;return/android/i.test(e)?(i=!0,t=e.toString().match(/android ([0-9]\.[0-9])\.?([0-9]?)/i),t&&t[1]&&(c=(parseFloat(t[1])+(t[2]?.01*t[2]:0)).toFixed(2))):/(iphone|ipad|ipod)/i.test(e)?(o=!0,t=e.toString().match(/([0-9]_[0-9])/i),t&&t[1]&&(c=parseFloat(t[1].replace(/_/,".")))):(n=!0,/(MSIE)/i.test(e)&&(a=!0,t=e.toString().match(/MSIE ([0-9])/i),t&&t[1]&&(c=parseInt(t[1],10)))),this._htDeviceInfo={desktop:n,android:i?c:!1,ios:o?c:!1,ie:a?c:!1,chrome:r,safari:s},this._htDeviceInfo},makeURL:function(e,t){return rainbowBr.scheme+"://"+e+"/"+t},extend:function(e,t){for(var n in t)e[n]=t[n]},excuteInMobile:function(e){console.log(e),rainbowBr.Util.getDeviceInfo().desktop!==!0?"undefined"!=typeof window.android?location.href=e:"undefined"!==rainbowBr.Util.getDeviceInfo().ios&&(location.href=e):console.log("desktop")},convertToNativeURL:function(e){var t,n=document.createElement("a");n.href=e;var i=n.protocol,o=n.hostname,a=n.port,r=n.pathname;return 0==r.indexOf("/")&&(r=r.substring(1)),"undefined"!=typeof i&&"undefined"!=typeof o&&"undefiend"!=typeof r?(t={},t.host="undefined"!=typeof a?i+"//"+o+":"+a:i+"//"+o,t.path=r,t):void 0},addSetAction:function(e,t){this._actions=this._actions||{},"undefined"!=typeof e.component&&(this._actions[e.component]=t)},setActionsCommit:function(){console.log(rainbowBr.scheme+"://util/setActionsCommit?"+JSON.stringify(this._actions)),location.href=rainbowBr.scheme+"://util/setActionsCommit?"+JSON.stringify(this._actions),delete this._actions}}))}(),rainbowBr.Component=rainbowBr.Class({$init:function(){this.component="component",this.instanceName="rbComponent"},_callback:function(e){"undefined"!=typeof this._requestCallback&&(this._requestCallback(e),delete this._requestCallback)},_excute:function(e,t){var n=rainbowBr.Util.makeURL(this.component,e);if("undefined"!=typeof t){if("undefined"!=typeof t.callback&&(t.instanceName=this.instanceName,t.callbackName="_callback",this._requestCallback=t.callback,delete t.callback),"undefined"!=typeof t.url){var i=rainbowBr.Util.convertToNativeURL(t.url);t.url=i.host+"/"+i.path}n+="?"+JSON.stringify(t)}rainbowBr.Util.excuteInMobile(n)},setInstanceName:function(e){this.instanceName=e}}),rainbowBr.Basic=rainbowBr.Class({$init:function(){this.component="basic",this.instanceName="rbBasic",this._requestUID=0,this._requestCallbacks={}},setInstanceName:function(e){this.instanceName=e,rainbowBr.Util.getDeviceInfo().android!==!1&&"undefined"!=typeof window.android&&window.android.setBasicInstanceName(rainbowBr.scheme,this.instanceName)},showProgress:function(e){this._excute("showProgress",e)},hideProgress:function(){this._excute("hideProgress")},showCustomProgress:function(e){this._excute("showCustomProgress",e)},hideCustomProgress:function(e){this._excute("hideCustomProgress",e)},showToast:function(e){"undefined"!=typeof e&&this._excute("showToast",e)},putLog:function(e){"undefined"!=typeof e&&this._excute("putLog",e)},_backKeyPress:function(){this.finish()},setBackKeyPress:function(e){this._backKeyPress=e},finish:function(){if(rainbowBr.Util.getDeviceInfo().android!==!1){var e;e=new rainbowBr.DroidX,e.end();var t=rainbowBr.Util.makeURL(this.component,"finish");setTimeout(function(){location.href=t},100)}},sendRequest:function(e){if("undefined"!=typeof e.type&&(e.method=e.type,delete e.type,"undefined"!=typeof e.data&&(e.param=e.data),delete e.data,"undefined"!=typeof e.url)){var t=rainbowBr.Util.convertToNativeURL(e.url);if("undefined"!=typeof t){rainbowBr.Util.extend(e,t),delete e.url,this._requestUID++,this._requestCallbacks[this._requestUID]=e.success,e.instanceName=this.instanceName,e.callback="_requestCallback",e.callbackID=""+this._requestUID;var n=rainbowBr.Util.makeURL(this.component,"sendRequest");n+="?"+JSON.stringify(e),rainbowBr.Util.excuteInMobile(n)}}},_requestCallback:function(e,t){this._requestCallbacks[e](t),delete this._requestCallbacks[e]},createShortcut:function(e){"undefined"!=typeof e&&this._excute("createShortcut",e)},goIntroPage:function(){this._excute("goIntroPage")},externOpenURL:function(e){"undefined"!=typeof e&&this._excute("externOpenURL",e)}},rainbowBr.Component)